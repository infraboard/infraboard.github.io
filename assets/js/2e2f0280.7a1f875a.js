"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[445],{826:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>c,metadata:()=>a,toc:()=>i});var t=r(5893),o=r(1151);const c={title:"GRPC\u63a5\u53e3",sidebar_label:"GRPC\u63a5\u53e3"},l=void 0,a={id:"framework/api/grpc",title:"GRPC\u63a5\u53e3",description:"\u4e0b\u9762\u662f\u4ee5\u4e00\u4e2agrpc \u7684hello world\u4e3a\u4f8b\u6f14\u793a",source:"@site/docs/framework/api/grpc.md",sourceDirName:"framework/api",slug:"/framework/api/grpc",permalink:"/docs/framework/api/grpc",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/framework/api/grpc.md",tags:[],version:"current",frontMatter:{title:"GRPC\u63a5\u53e3",sidebar_label:"GRPC\u63a5\u53e3"},sidebar:"framework",previous:{title:"HTTP\u63a5\u53e3",permalink:"/docs/framework/api/http"},next:{title:"\u57fa\u7840\u914d\u7f6e",permalink:"/docs/framework/config/"}},s={},i=[{value:"\u4f7f\u7528protobuf\u5b9a\u4e49\u63a5\u53e3",id:"\u4f7f\u7528protobuf\u5b9a\u4e49\u63a5\u53e3",level:2},{value:"GRPCControllerObject\u63a5\u53e3",id:"grpccontrollerobject\u63a5\u53e3",level:2},{value:"\u5b9e\u73b0GRPC\u670d\u52a1\u7aef",id:"\u5b9e\u73b0grpc\u670d\u52a1\u7aef",level:2},{value:"\u6ce8\u518cGRPC\u5bf9\u8c61",id:"\u6ce8\u518cgrpc\u5bf9\u8c61",level:2},{value:"\u542f\u52a8\u670d\u52a1",id:"\u542f\u52a8\u670d\u52a1",level:2},{value:"\u7f16\u5199\u5ba2\u6237\u7aef\u5e76\u8fdb\u884c\u6d4b\u8bd5",id:"\u7f16\u5199\u5ba2\u6237\u7aef\u5e76\u8fdb\u884c\u6d4b\u8bd5",level:2}];function p(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"\u4e0b\u9762\u662f\u4ee5\u4e00\u4e2agrpc \u7684hello world\u4e3a\u4f8b\u6f14\u793a"}),"\n",(0,t.jsx)(n.h2,{id:"\u4f7f\u7528protobuf\u5b9a\u4e49\u63a5\u53e3",children:"\u4f7f\u7528protobuf\u5b9a\u4e49\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"\u5173\u4e8e\u5982\u4f55\u5b9a\u4e49protobuf\u548c\u4f7f\u7528 \u8bf7\u53c2\u8003protobuf\u5b98\u65b9\u6587\u6863"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage infraboard.mcube.example;\noption go_package = "github.com/infraboard/mcube/v2/examples/rpc_grpc/pb";\n\n// Hello world \u6837\u4f8b\nservice Hello {\n    rpc Greet(GreetRequest) returns(GreetResponse);\n}\n\nmessage GreetRequest {\n    string name = 1;\n}\n\nmessage GreetResponse {\n    string msg = 2;\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"grpccontrollerobject\u63a5\u53e3",children:"GRPCControllerObject\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"\u5b9e\u73b0\u4e86GRPCControllerObject\u63a5\u53e3\u7684\u5bf9\u8c61\uff0c\u4f1a\u88ab\u81ea\u52a8\u6ce8\u518c\u7ed9 grpc\u670d\u52a1\u5668"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"type GRPCControllerObject interface {\n\tObject\n\tRegistry(*grpc.Server)\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5b9e\u73b0grpc\u670d\u52a1\u7aef",children:"\u5b9e\u73b0GRPC\u670d\u52a1\u7aef"}),"\n",(0,t.jsx)(n.p,{children:"\u5b9a\u4e49HelloGrpc\u5bf9\u8c61:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:'type HelloGrpc struct {\n\t// \u7ee7\u627f\u81eaIoc\u5bf9\u8c61\n\tioc.ObjectImpl\n\t// \u96c6\u6210Grpc Server\u5bf9\u8c61\n\tpb.UnimplementedHelloServer\n}\n\nfunc (h *HelloGrpc) Name() string {\n\treturn "hello_module"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5b9e\u73b0GRPCControllerObject\u63a5\u53e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"func (h *HelloGrpc) Registry(server *grpc.Server) {\n\tpb.RegisterHelloServer(server, h)\n}\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5b9e\u73b0GRPC\u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:'func (h *HelloGrpc) Greet(ctx context.Context, in *pb.GreetRequest) (*pb.GreetResponse, error) {\n\treturn &pb.GreetResponse{\n\t\tMsg: fmt.Sprintf("hello, %s", in.Name),\n\t}, nil\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u6ce8\u518cgrpc\u5bf9\u8c61",children:"\u6ce8\u518cGRPC\u5bf9\u8c61"}),"\n",(0,t.jsx)(n.p,{children:"GRPC\u662f\u5c5e\u4e8e\u670d\u52a1\u7aef\u63a7\u5236\u5668, \u9700\u8981\u6ce8\u518c\u5230\u63a7\u5236\u5668\u7a7a\u95f4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"// \u6ce8\u518cHTTP\u63a5\u53e3\u7c7b\nioc.Controller().Registry(&HelloGrpc{})\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u542f\u52a8\u670d\u52a1",children:"\u542f\u52a8\u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"// \u542f\u52a8\u5e94\u7528\nerr = application.App().Start(context.Background())\nif err != nil {\n    panic(err)\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230grpc\u7684\u5bf9\u8c61 hello_module.v1 \u5df2\u7ecf\u6ce8\u518c, \u5e76\u4e14\u670d\u52a1\u76d1\u542c\u5728127.0.0.1:18080"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"$ Golang/inforboard/mcube \u2039master*\u203a \xbb go run examples/rpc_grpc/server/main.go \n2023-12-18T15:27:03+08:00 INFO   config/application/application.go:106 > loaded configs: [log.v1 app.v1] component:APPLICATION\n2023-12-18T15:27:03+08:00 INFO   config/application/application.go:107 > loaded controllers: [hello_module.v1] component:APPLICATION\n2023-12-18T15:27:03+08:00 INFO   config/application/application.go:108 > loaded apis: [] component:APPLICATION\n2023-12-18T15:27:03+08:00 INFO   config/application/grpc.go:119 > GRPC \u670d\u52a1\u76d1\u542c\u5730\u5740: 127.0.0.1:18080 component:GRPC\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u7f16\u5199\u5ba2\u6237\u7aef\u5e76\u8fdb\u884c\u6d4b\u8bd5",children:"\u7f16\u5199\u5ba2\u6237\u7aef\u5e76\u8fdb\u884c\u6d4b\u8bd5"}),"\n",(0,t.jsx)(n.p,{children:"\u7f16\u5199\u5ba2\u6237\u7aef"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:'func main() {\n\t// \u8fde\u63a5\u5230\u670d\u52a1\n\tconn, err := grpc.Dial(\n\t\t"127.0.0.1:18080",\n\t\tgrpc.WithTransportCredentials(insecure.NewCredentials()),\n\t)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tresp, err := pb.NewHelloClient(conn).Greet(context.Background(), &pb.GreetRequest{\n\t\tName: "old yu",\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tfmt.Println(resp)\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u8fdb\u884c\u6d4b\u8bd5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'$ Golang/inforboard/mcube \u2039master*\u203a \xbb go run examples/rpc_grpc/client/main.go                                                                                            1 \u21b5\nmsg:"hello, old yu"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u5b8c\u6574\u7684\u4f8b\u5b50\u8bf7\u67e5\u770b: ",(0,t.jsx)(n.a,{href:"https://github.com/infraboard/mcube/blob/master/examples/rpc_grpc",children:"gin"})]})]})}function d(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>l});var t=r(7294);const o={},c=t.createContext(o);function l(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);